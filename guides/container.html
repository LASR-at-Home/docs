<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-guides/container">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Container Maintenance | LASR Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://lasr-at-home.github.io/docs/guides/container"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Container Maintenance | LASR Documentation"><meta data-rh="true" name="description" content="This document describes the entire structure of the RoboCup container definition as well as how to build it."><meta data-rh="true" property="og:description" content="This document describes the entire structure of the RoboCup container definition as well as how to build it."><link data-rh="true" rel="canonical" href="https://lasr-at-home.github.io/docs/guides/container"><link data-rh="true" rel="alternate" href="https://lasr-at-home.github.io/docs/guides/container" hreflang="en"><link data-rh="true" rel="alternate" href="https://lasr-at-home.github.io/docs/guides/container" hreflang="x-default"><link rel="stylesheet" href="/docs/assets/css/styles.74ed16b8.css">
<link rel="preload" href="/docs/assets/js/runtime~main.d714739a.js" as="script">
<link rel="preload" href="/docs/assets/js/main.8150ec97.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/docs/"><b class="navbar__title text--truncate">LASR Documentation</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">LASR Documentation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/guides/container">Guides</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/guides/container">Container Maintenance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/virtualenv">Configuring Python dependencies for packages</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/tasks/coffee_shop">Tasks</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/packages/aruco_service">Packages</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Guides</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Container Maintenance</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Container Maintenance</h1><p>This document describes the entire structure of the RoboCup container definition as well as how to build it.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="building">Building<a href="#building" class="hash-link" aria-label="Direct link to Building" title="Direct link to Building">​</a></h2><p>To build the container, ensure you have a copy of the TIAGo Melodic container and then proceed with:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/lasr-at-home/containers.git ~/containers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> ~/containers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># copy TIAGo container to tiago_noetic_opensource.sif to current directory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> apptainer build robocup_container.sif robocup_container.def</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><p>This likely doesn&#x27;t work with the proprietary PAL container for the time being.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="debugging-build-process">Debugging build process<a href="#debugging-build-process" class="hash-link" aria-label="Direct link to Debugging build process" title="Direct link to Debugging build process">​</a></h3><p>You can save a lot of time debugging build errors by redirecting all output to a file:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">rm</span><span class="token plain"> build.log </span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/dev/null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> apptainer build robocup_container.sif robocup_container.def </span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token file-descriptor important">&amp;1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">tee</span><span class="token plain"> build.log</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="checking-when-container-was-built">Checking when container was built<a href="#checking-when-container-was-built" class="hash-link" aria-label="Direct link to Checking when container was built" title="Direct link to Checking when container was built">​</a></h3><p>You can quickly check what container you&#x27;re using by running the following:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /.build_info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RoboCup Container </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Version: 0001, Bootstrapped from: oss, Build date: 09-11-2023, Build took: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> days </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> hours </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> minutes </span><span class="token number" style="color:#36acaa">36</span><span class="token plain"> seconds</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="testing-new-dependencies">Testing new dependencies<a href="#testing-new-dependencies" class="hash-link" aria-label="Direct link to Testing new dependencies" title="Direct link to Testing new dependencies">​</a></h3><p>If you&#x27;d like to test new dependencies without rebuilding the entire container, you can use the <code>test_container_template</code> definition file.</p><p>After building the RoboCup container, you can then run:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> apptainer build test_container_template.sif test_container_template.def</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># .. with log:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">rm</span><span class="token plain"> build.log </span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/dev/null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> apptainer build test_container_template.sif test_container_template.def </span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token file-descriptor important">&amp;1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">tee</span><span class="token plain"> build.log</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="container">Container<a href="#container" class="hash-link" aria-label="Direct link to Container" title="Direct link to Container">​</a></h2><p>This section goes over how the container is built.</p><p>We use the TIAGo Noetic container as a base which uses Ubuntu 21.04 as a base itself.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-packages-from-repositories">Install packages from repositories<a href="#install-packages-from-repositories" class="hash-link" aria-label="Direct link to Install packages from repositories" title="Direct link to Install packages from repositories">​</a></h3><ol><li><p>Ensure the container is up to date by updating and upgrading from PAL apt repositories.</p></li><li><p>Install additional apt packages</p><table><thead><tr><th align="center">Package</th><th>Description</th></tr></thead><tbody><tr><td align="center">ros-melodic-audio-common</td><td>provides various ROS packages for capturing and playing back audio</td></tr><tr><td align="center">python3-numpy</td><td>numpy package for Python 3.6</td></tr><tr><td align="center">python3-opencv</td><td>cv2 package for Python 3.6</td></tr><tr><td align="center">libasound-dev<br>libportaudio2<br>libportaudiocpp0<br>portaudio19-dev</td><td>libraries required to build PyAudio wheel</td></tr><tr><td align="center">ffmpeg</td><td>record, convert, and stream audio / video</td></tr><tr><td align="center">python3-testresources<br>python3-empy</td><td>dependencies for catkin_virtualenv</td></tr><tr><td align="center">ca-certificates<br>curl<br>gnupg</td><td>generic requirements required by most things</td></tr><tr><td align="center">bc</td><td>arithmetic for the terminal, used in container build script</td></tr></tbody></table></li></ol><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>Software packages on PAL repositories are quite old, there are situations where it is advisable to install software through alternative means.</p></div></div><ol start="3"><li><p>Install Node.js 20 (LTS as of 09-11-2023)</p><p>All available distributions are <a href="https://github.com/nodesource/distributions" target="_blank" rel="noopener noreferrer">listed here</a>.</p></li><li><p>Create a temporary <code>/deps</code> folder which will be used to build additional dependencies in.</p></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-python-from-source">Install Python from source<a href="#install-python-from-source" class="hash-link" aria-label="Direct link to Install Python from source" title="Direct link to Install Python from source">​</a></h3><p>We install Python 3.9 and 3.10 to take advantage of modern Python libraries which no longer support Python 3.8, we can selectively choose to use it for some of our packages through the use of <a href="/docs/guides/virtualenv">catkin virtualenv</a>. This build step is derived from the <a href="https://devguide.python.org/getting-started/setup-building/" target="_blank" rel="noopener noreferrer">Python documentation</a>.</p><ol><li><p>Install dependencies required for build.</p><p>We choose to build all optional Python modules for maximum compatibility.</p></li><li><p>Download Python sources and extract.</p></li><li><p>Build Python sources and install globally.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>This will override the global Python installation, this is cleaned up in a later build step.</p></div></div></li><li><p>Install additional global packages.</p><table><thead><tr><th align="center">Package</th><th align="center">Version</th><th>Description</th></tr></thead><tbody><tr><td align="center">pyyaml</td><td align="center">6.0.1</td><td>provides yaml package (required by rospy)</td></tr><tr><td align="center">rospkg</td><td align="center">1.5.0</td><td>environment agnostic ROS package utilities (required by rospy)</td></tr><tr><td align="center">pip</td><td align="center">23.2.1</td><td>Python package manager</td></tr><tr><td align="center">setuptools</td><td align="center">68.0.0</td><td>Python build tools</td></tr><tr><td align="center">wheel</td><td align="center">0.41.1</td><td>Python build tools</td></tr></tbody></table></li></ol><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>We install from source as it&#x27;s not available in PAL repositories and Python
is no longer available from the deadsnakes PPA as Ubuntu 18.04 has lost support.
When migrating this build step to noetic, you may be able to just use the
deadsnakes repository like:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> software-properties-common -y </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> apt-add-repository ppa:deadsnakes/ppa </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> update </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> python3.8 python3.8-dev python3-setuptools </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"> etc</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>NB. update our definition to use this if Ubuntu 21.04 is still supported.</p></div></div><div class="theme-admonition theme-admonition-warning alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><p>Python 3.11+ is incompatible with rospy (Melodic &amp; Noetic)</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-global-python-installation">Configure global Python installation<a href="#configure-global-python-installation" class="hash-link" aria-label="Direct link to Configure global Python installation" title="Direct link to Configure global Python installation">​</a></h3><ol><li><p>Reconfigure Python symlinks</p><ul><li><code>/usr/bin/python</code> is made to point to Python 3.8</li><li><code>/usr/local/bin/python3</code> is removed to restore Python 3.8 for <code>python3</code></li></ul></li><li><p><del>Install additional Python 3.6 packages</del></p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>As Python 3.6 is no longer available in the base container, this has been momentarily removed.</p></div></div><table><thead><tr><th align="center">Package</th><th align="center">Version</th><th>Description</th></tr></thead><tbody><tr><td align="center">rosnumpy</td><td align="center">0.0.5.2</td><td>conversion helper between ROS and numpy †</td></tr><tr><td align="center">scipy</td><td align="center">1.5.4</td><td>mathematics library</td></tr><tr><td align="center">black</td><td align="center">22.8.0</td><td>Python code formatter</td></tr><tr><td align="center">scikit-build</td><td align="center">0.16.7</td><td>build system for CPython C/C++/Fortran/Cython extensions using CMake</td></tr><tr><td align="center">scikit-learn</td><td align="center">0.24.2</td><td>machine learning and data mining</td></tr><tr><td align="center">nvidia-ml-py3</td><td align="center">7.352.0</td><td>bindings for NVIDIA Management Library</td></tr><tr><td align="center">torch</td><td align="center">1.9.1+cpu</td><td>neural networks</td></tr><tr><td align="center">torchvision</td><td align="center">0.10.1+cpu</td><td>torch extension for vision</td></tr><tr><td align="center">torchaudio</td><td align="center">0.9.1</td><td>torch extension for audio</td></tr></tbody></table><p>† This library does not work on Python 3.10, ROS packages upgrading to newer Python versions must find a substitute.</p><p>‡ Installed with CPU support only, <a href="https://pytorch.org/get-started/previous-versions/#linux-and-windows-17" target="_blank" rel="noopener noreferrer">see this page for more information</a>.</p></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-overlay-workspace-for-additional-ros-packages">Create overlay workspace for additional ROS packages<a href="#create-overlay-workspace-for-additional-ros-packages" class="hash-link" aria-label="Direct link to Create overlay workspace for additional ROS packages" title="Direct link to Create overlay workspace for additional ROS packages">​</a></h3><ol><li><p>Create a new overlay workspace</p></li><li><p>Clone ROS packages we want to build from source</p><table><thead><tr><th align="center">Package</th><th>Description</th><th>Source</th></tr></thead><tbody><tr><td align="center">catkin_virtualenv</td><td>Bundle python requirements in a catkin package via virtualenv</td><td><a href="https://github.com/locusrobotics/catkin_virtualenv" target="_blank" rel="noopener noreferrer">locusrobotics/catkin_virtualenv</a> @ <code>4af9970</code></td></tr><tr><td align="center">video_stream_opencv</td><td>Package providing various utilities concerning capturing and playing videos</td><td><a href="https://github.com/ros-drivers/video_stream_opencv" target="_blank" rel="noopener noreferrer">ros-drivers/video_stream_opencv</a> @ <code>65949bd</code></td></tr></tbody></table></li><li><p>Build the workspace</p></li><li><p>Add workspace setup to container environment</p><p>We hijack <code>/opt/env.sh</code> and add our workspace at the end of the source chain.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>This relies on the TIAGo PAL or open source containers being used as a base to detect where the line should be added.</p></div></div></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="perform-clean-up">Perform clean up<a href="#perform-clean-up" class="hash-link" aria-label="Direct link to Perform clean up" title="Direct link to Perform clean up">​</a></h3><ol><li><p>Remove the build folder <code>/deps</code></p></li><li><p>Generate build information for future reference</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /.build_info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RoboCup Container </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Version: 0001, Bootstrapped from: oss, Build date: 09-11-2023, Build took: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> days </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> hours </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> minutes </span><span class="token number" style="color:#36acaa">36</span><span class="token plain"> seconds</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Remove extraneous environment variables</p></li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/lasr-at-home/base/blob/main/common/document_lasr/web/docs/guides/container.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">LASR Documentation</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/guides/virtualenv"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Configuring Python dependencies for packages</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#building" class="table-of-contents__link toc-highlight">Building</a><ul><li><a href="#debugging-build-process" class="table-of-contents__link toc-highlight">Debugging build process</a></li><li><a href="#checking-when-container-was-built" class="table-of-contents__link toc-highlight">Checking when container was built</a></li><li><a href="#testing-new-dependencies" class="table-of-contents__link toc-highlight">Testing new dependencies</a></li></ul></li><li><a href="#container" class="table-of-contents__link toc-highlight">Container</a><ul><li><a href="#install-packages-from-repositories" class="table-of-contents__link toc-highlight">Install packages from repositories</a></li><li><a href="#install-python-from-source" class="table-of-contents__link toc-highlight">Install Python from source</a></li><li><a href="#configure-global-python-installation" class="table-of-contents__link toc-highlight">Configure global Python installation</a></li><li><a href="#create-overlay-workspace-for-additional-ros-packages" class="table-of-contents__link toc-highlight">Create overlay workspace for additional ROS packages</a></li><li><a href="#perform-clean-up" class="table-of-contents__link toc-highlight">Perform clean up</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/docs/assets/js/runtime~main.d714739a.js"></script>
<script src="/docs/assets/js/main.8150ec97.js"></script>
</body>
</html>